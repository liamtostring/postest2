{"version":3,"names":["compact","find","get","omit","flattenFilters","filters","allFilters","forEach","f","subFilters","push","apply","_toConsumableArray","getActiveFiltersFromQuery","query","config","Object","keys","map","configKey","filter","rules","match","rule","hasOwnProperty","getUrlKey","value","key","getDefaultOptionValue","options","defaultOption","input","option","console","warn","concat","labels","add","undefined","getQueryFromActiveFilters","activeFilters","previousFilters","previousData","reduce","data","nextData","Array","isArray","some","_objectSpread","length"],"sources":["/home/users/vikas.reactjs/www/html/king/wp-content/plugins/woo-point-of-sale/packages/navigation/src/filters.js"],"sourcesContent":["/** @format */\n/**\n * External dependencies\n */\nimport { compact, find, get, omit } from 'lodash';\n\n/**\n * Collapse an array of filter values with subFilters into a 1-dimensional array.\n *\n * @param {Array} filters Set of filters with possible subfilters.\n * @return {Array} Flattened array of all filters.\n */\nexport function flattenFilters( filters ) {\n\tconst allFilters = [];\n\tfilters.forEach( f => {\n\t\tif ( ! f.subFilters ) {\n\t\t\tallFilters.push( f );\n\t\t} else {\n\t\t\tallFilters.push( omit( f, 'subFilters' ) );\n\t\t\tconst subFilters = flattenFilters( f.subFilters );\n\t\t\tallFilters.push( ...subFilters );\n\t\t}\n\t} );\n\treturn allFilters;\n}\n\n/**\n * Describe activeFilter object.\n *\n * @typedef {Object} activeFilter\n * @property {string} key - filter key.\n * @property {string} [rule] - a modifying rule for a filter, eg 'includes' or 'is_not'.\n * @property {string} value - filter value(s).\n */\n\n/**\n * Given a query object, return an array of activeFilters, if any.\n *\n * @param {object} query - query oject\n * @param {object} config - config object\n * @return {activeFilters[]} - array of activeFilters\n */\nexport function getActiveFiltersFromQuery( query, config ) {\n\treturn compact(\n\t\tObject.keys( config ).map( configKey => {\n\t\t\tconst filter = config[ configKey ];\n\t\t\tif ( filter.rules ) {\n\t\t\t\tconst match = find( filter.rules, rule => {\n\t\t\t\t\treturn query.hasOwnProperty( getUrlKey( configKey, rule.value ) );\n\t\t\t\t} );\n\n\t\t\t\tif ( match ) {\n\t\t\t\t\tconst value = query[ getUrlKey( configKey, match.value ) ];\n\t\t\t\t\treturn {\n\t\t\t\t\t\tkey: configKey,\n\t\t\t\t\t\trule: match.value,\n\t\t\t\t\t\tvalue,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tif ( query[ configKey ] ) {\n\t\t\t\treturn {\n\t\t\t\t\tkey: configKey,\n\t\t\t\t\tvalue: query[ configKey ],\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn null;\n\t\t} )\n\t);\n}\n\n/**\n * Get the default option's value from the configuration object for a given filter. The first\n * option is used as default if no `defaultOption` is provided.\n *\n * @param {object} config - a filter config object.\n * @param {array} options - select options.\n * @return {string|undefined}  - the value of the default option.\n */\nexport function getDefaultOptionValue( config, options ) {\n\tconst { defaultOption } = config.input;\n\tif ( config.input.defaultOption ) {\n\t\tconst option = find( options, { value: defaultOption } );\n\t\tif ( ! option ) {\n\t\t\t/* eslint-disable no-console */\n\t\t\tconsole.warn( `invalid defaultOption ${ defaultOption } supplied to ${ config.labels.add }` );\n\t\t\t/* eslint-enable */\n\t\t\treturn undefined;\n\t\t}\n\t\treturn option.value;\n\t}\n\treturn get( options, [ 0, 'value' ] );\n}\n\n/**\n * Given activeFilters, create a new query object to update the url. Use previousFilters to\n * Remove unused params.\n *\n * @param {activeFilters[]} activeFilters - activeFilters shown in the UI\n * @param {object} query - the current url query object\n * @param {object} config - config object\n * @return {object} - query object representing the new parameters\n */\nexport function getQueryFromActiveFilters( activeFilters, query, config ) {\n\tconst previousFilters = getActiveFiltersFromQuery( query, config );\n\tconst previousData = previousFilters.reduce( ( data, filter ) => {\n\t\tdata[ getUrlKey( filter.key, filter.rule ) ] = undefined;\n\t\treturn data;\n\t}, {} );\n\tconst nextData = activeFilters.reduce( ( data, filter ) => {\n\t\tif (\n\t\t\t'between' === filter.rule &&\n\t\t\t( ! Array.isArray( filter.value ) || filter.value.some( value => ! value ) )\n\t\t) {\n\t\t\treturn data;\n\t\t}\n\n\t\tif ( filter.value ) {\n\t\t\tdata[ getUrlKey( filter.key, filter.rule ) ] = filter.value;\n\t\t}\n\t\treturn data;\n\t}, {} );\n\n\treturn { ...previousData, ...nextData };\n}\n\n/**\n * Get the url query key from the filter key and rule.\n *\n * @param {string} key - filter key.\n * @param {string} rule - filter rule.\n * @return {string} - url query key.\n */\nexport function getUrlKey(key, rule) {\n\tif ( rule && rule.length ) {\n\t\treturn `${ key }_${ rule }`;\n\t}\n\treturn key;\n}\n"],"mappings":"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"}