{"version":3,"names":["_lodash","require","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty2","default","getOwnPropertyDescriptors","defineProperties","defineProperty","flattenFilters","filters","allFilters","f","subFilters","omit","_toConsumableArray2","getActiveFiltersFromQuery","query","config","compact","map","configKey","rules","match","find","rule","hasOwnProperty","getUrlKey","value","getDefaultOptionValue","options","defaultOption","input","option","console","warn","concat","labels","add","undefined","get","getQueryFromActiveFilters","activeFilters","previousFilters","previousData","reduce","data","nextData","Array","isArray","some"],"sources":["/home/users/vikas.reactjs/www/html/king/wp-content/plugins/woo-point-of-sale/packages/navigation/src/filters.js"],"sourcesContent":["/** @format */\n/**\n * External dependencies\n */\nimport { compact, find, get, omit } from 'lodash';\n\n/**\n * Collapse an array of filter values with subFilters into a 1-dimensional array.\n *\n * @param {Array} filters Set of filters with possible subfilters.\n * @return {Array} Flattened array of all filters.\n */\nexport function flattenFilters( filters ) {\n\tconst allFilters = [];\n\tfilters.forEach( f => {\n\t\tif ( ! f.subFilters ) {\n\t\t\tallFilters.push( f );\n\t\t} else {\n\t\t\tallFilters.push( omit( f, 'subFilters' ) );\n\t\t\tconst subFilters = flattenFilters( f.subFilters );\n\t\t\tallFilters.push( ...subFilters );\n\t\t}\n\t} );\n\treturn allFilters;\n}\n\n/**\n * Describe activeFilter object.\n *\n * @typedef {Object} activeFilter\n * @property {string} key - filter key.\n * @property {string} [rule] - a modifying rule for a filter, eg 'includes' or 'is_not'.\n * @property {string} value - filter value(s).\n */\n\n/**\n * Given a query object, return an array of activeFilters, if any.\n *\n * @param {object} query - query oject\n * @param {object} config - config object\n * @return {activeFilters[]} - array of activeFilters\n */\nexport function getActiveFiltersFromQuery( query, config ) {\n\treturn compact(\n\t\tObject.keys( config ).map( configKey => {\n\t\t\tconst filter = config[ configKey ];\n\t\t\tif ( filter.rules ) {\n\t\t\t\tconst match = find( filter.rules, rule => {\n\t\t\t\t\treturn query.hasOwnProperty( getUrlKey( configKey, rule.value ) );\n\t\t\t\t} );\n\n\t\t\t\tif ( match ) {\n\t\t\t\t\tconst value = query[ getUrlKey( configKey, match.value ) ];\n\t\t\t\t\treturn {\n\t\t\t\t\t\tkey: configKey,\n\t\t\t\t\t\trule: match.value,\n\t\t\t\t\t\tvalue,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tif ( query[ configKey ] ) {\n\t\t\t\treturn {\n\t\t\t\t\tkey: configKey,\n\t\t\t\t\tvalue: query[ configKey ],\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn null;\n\t\t} )\n\t);\n}\n\n/**\n * Get the default option's value from the configuration object for a given filter. The first\n * option is used as default if no `defaultOption` is provided.\n *\n * @param {object} config - a filter config object.\n * @param {array} options - select options.\n * @return {string|undefined}  - the value of the default option.\n */\nexport function getDefaultOptionValue( config, options ) {\n\tconst { defaultOption } = config.input;\n\tif ( config.input.defaultOption ) {\n\t\tconst option = find( options, { value: defaultOption } );\n\t\tif ( ! option ) {\n\t\t\t/* eslint-disable no-console */\n\t\t\tconsole.warn( `invalid defaultOption ${ defaultOption } supplied to ${ config.labels.add }` );\n\t\t\t/* eslint-enable */\n\t\t\treturn undefined;\n\t\t}\n\t\treturn option.value;\n\t}\n\treturn get( options, [ 0, 'value' ] );\n}\n\n/**\n * Given activeFilters, create a new query object to update the url. Use previousFilters to\n * Remove unused params.\n *\n * @param {activeFilters[]} activeFilters - activeFilters shown in the UI\n * @param {object} query - the current url query object\n * @param {object} config - config object\n * @return {object} - query object representing the new parameters\n */\nexport function getQueryFromActiveFilters( activeFilters, query, config ) {\n\tconst previousFilters = getActiveFiltersFromQuery( query, config );\n\tconst previousData = previousFilters.reduce( ( data, filter ) => {\n\t\tdata[ getUrlKey( filter.key, filter.rule ) ] = undefined;\n\t\treturn data;\n\t}, {} );\n\tconst nextData = activeFilters.reduce( ( data, filter ) => {\n\t\tif (\n\t\t\t'between' === filter.rule &&\n\t\t\t( ! Array.isArray( filter.value ) || filter.value.some( value => ! value ) )\n\t\t) {\n\t\t\treturn data;\n\t\t}\n\n\t\tif ( filter.value ) {\n\t\t\tdata[ getUrlKey( filter.key, filter.rule ) ] = filter.value;\n\t\t}\n\t\treturn data;\n\t}, {} );\n\n\treturn { ...previousData, ...nextData };\n}\n\n/**\n * Get the url query key from the filter key and rule.\n *\n * @param {string} key - filter key.\n * @param {string} rule - filter rule.\n * @return {string} - url query key.\n */\nexport function getUrlKey(key, rule) {\n\tif ( rule && rule.length ) {\n\t\treturn `${ key }_${ rule }`;\n\t}\n\treturn key;\n}\n"],"mappings":"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"}